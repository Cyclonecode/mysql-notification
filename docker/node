FROM node:18.7

WORKDIR /usr/src/app
COPY . .
RUN npm i

ARG MYSQL_USERNAME
ARG MYSQL_PASSWORD
ARG MYSQL_DATABASE
ARG MYSQL_HOSTNAME
ARG MYSQL_PORT
ARG SSL_ENABLED
ARG SSL_KEY
ARG SSL_CERTIFICATE
ARG SERVER_PORT
ARG SERVER_ADDRESS
ARG WEBSOCKET_PORT
ARG AUTO_ACCEPT_CONNECTION
ARG ALLOWED_ORIGINS

ENV MYSQL_USERNAME=$MYSQL_USERNAME
ENV MYSQL_PASSWORD=$MYSQL_PASSWORD
ENV MYSQL_DATABASE=$MYSQL_DATABASE
ENV MYSQL_HOSTNAME=$MYSQL_HOSTNAME
ENV MYSQL_PORT=$MYSQL_PORT
ENV SSL_ENABLED=$SSL_ENABLED
ENV SSL_KEY=$SSL_KEY
ENV SSL_CERTIFICATE=$SSL_CERTIFICATE
ENV SERVER_PORT=$SERVER_PORT
ENV SERVER_ADDRESS=$SERVER_ADDRESS
ENV WEBSOCKET_PORT=$WEBSOCKET_PORT
ENV AUTO_ACCEPT_CONNECTION=$AUTO_ACCEPT_CONNECTION
ENV ALLOWED_ORIGINS=$ALLOWED_ORIGINS

EXPOSE $WEBSOCKET_PORT

CMD ["npm", "run", "dev"]
